<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QH FbToolkit</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .border-box {
            border-radius: 10px;
            border: 2px solid #ddd;
            padding: 15px;
            margin-top: 20px;
        }
        .image-preview {
            display: flex;
            flex-wrap: wrap;
        }
        .image-preview img {
            max-width: 100px;
            margin: 5px;
        }
        .image-preview .btn-delete {
            display: block;
            text-align: center;
            cursor: pointer;
            color: red;
        }
    </style>
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <a class="navbar-brand" href="#">
        <img src="/icon.webp" width="30" height="30" alt="">
        QH FbToolkit
      </a>

  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav mr-auto">
      <li class="nav-item active">
        <a class="nav-link" href="#">Home</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#">Post view</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#">Group view</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#">Comment view</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/docs.html">Docs</a>
      </li>
    </ul>
  </div>
</nav>


<div class="container">
    <div class="row">
        <!-- C·ªôt 1 -->
        <div class="col-md-8 pt-5">
            <div class="row pt-2 pb-5" style="border: 2px solid #ddd; border-radius: 10px;">
                <div class="col-md-12">
                    <h3>Auto post to group</h3>
                    <div class="form-group">
                        <label for="title">Title</label>
                        <input type="text" id="title" class="form-control" name="title" placeholder="Ti√™u ƒë·ªÅ b√†i ƒëƒÉng">
                    </div>
                    <div class="form-group">
                        <label for="paragraph">Paragraph</label>
                        <textarea id="paragraph" class="form-control" name="paragraph" rows="14" placeholder="N·ªôi dung b√†i ƒëƒÉng"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="images">Upload Images</label>
                        <input type="file" id="images" class="form-control-file" multiple>
                        <div class="image-preview" id="image-preview"></div>
                    </div>
                    <button id="submit" class="btn btn-primary">Save</button>
                </div>
            </div>
            <br>
            <div class="row pt-2 pb-5" style="border: 2px solid #ddd; border-radius: 10px;">
                <div class="col-md-12">
                    <h3>M·ªôt s·ªë m·∫πo:</h3>
                    <p>H√£y d√πng l·ªánh <span style="color: green;">/tym/</span> ƒë·ªÉ random ra nh·ªØng h√¨nh tym emoji b·∫•t k·ª≥</p>
                    <p>H√£y d√πng l·ªánh <span style="color: green;">/tym xn/</span> ƒë·ªÉ random ra nh·ªØng h√¨nh tym emoji b·∫•t k·ª≥ v·ªõi <b>n</b> l·∫ßn.
                     V√≠ d·ª• <span style="color: green;">/tym x3/</span> => üíïüíóüíò</p>
                    <p>T∆∞∆°ng t·ª± v·ªõi l·ªánh <span style="color: green;">/flower/</pre></p>
                    <p>H√£y d√πng th∆∞·ªùng xuy√™n ƒë·ªÉ tr√°nh b·ªã checkpoint!</p>
                </div>
            </div>
            <br>
            <div class="row pt-2 pb-5" style="border: 2px solid #ddd; border-radius: 10px;">
                <div class="col-md-12">
                    <h3>Auto comment to page/group - <span style="color: red;">No support</span></h3>
                    <div class="form-group">
                        <label for="cmt-title">Comment Title</label>
                        <input type="text" id="cmt-title" class="form-control" name="cmt-title" disabled>
                    </div>
                    <div class="form-group">
                        <label for="comment">Comment</label>
                        <textarea id="comment" class="form-control" name="comment" rows="14" disabled></textarea>
                    </div>
                    <div class="form-group">
                        <label for="images">Upload Images</label>
                        <input type="file" id="images" class="form-control-file" multiple disabled>
                        <div class="image-preview" id="image-preview"></div>
                    </div>
                    <button id="submit" class="btn btn-primary" disabled>Submit</button>
                </div>
            </div>
        </div>

        <!-- C·ªôt 2 -->
        <div class="col-md-4 pt-4">
            <div class="border-box" style="height: 36%; overflow-y: auto;">
                <ul id="post-list">
                    <!-- Danh s√°ch b√†i ƒëƒÉng s·∫Ω ƒë∆∞·ª£c ch√®n v√†o ƒë√¢y -->
                    <li><a href="#">Post 1</a></li>
                </ul>
            </div>
            <div class="border-box" style="height: 40%; overflow-y: auto;">
                <p>comment list...<br>No support</p>
            </div>
        </div>
    </div>
</div>

<div class="container">
  <footer class="py-3 my-4">
    <ul class="nav justify-content-center border-bottom pb-3 mb-3">
      <li class="nav-item"><a href="#" class="nav-link px-2 text-muted">Home</a></li>
      <li class="nav-item"><a href="#" class="nav-link px-2 text-muted">Features</a></li>
      <li class="nav-item"><a href="#" class="nav-link px-2 text-muted">Pricing</a></li>
      <li class="nav-item"><a href="#" class="nav-link px-2 text-muted">FAQs</a></li>
      <li class="nav-item"><a href="#" class="nav-link px-2 text-muted">About</a></li>
    </ul>
    <p class="text-center text-muted">¬© 2024 | NDH - Hue city</p>
  </footer>
</div>

<script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-database.js"></script>
<script>
// Firebase configuration
var firebaseConfig = {
    databaseURL: "https://qhfbkit-default-rtdb.asia-southeast1.firebasedatabase.app/"
};

// Initialize Firebase
firebase.initializeApp(firebaseConfig);

document.addEventListener('DOMContentLoaded', function() {
    var imageInput = document.getElementById('images');
    var imagePreview = document.getElementById('image-preview');
    var postList = document.getElementById('post-list');

    // Hi·ªÉn th·ªã danh s√°ch b√†i ƒëƒÉng t·ª´ Firebase
    firebase.database().ref('/').on('value', function(snapshot) {
        postList.innerHTML = ''; // Clear the list before adding new items
        snapshot.forEach(function(childSnapshot) {
            var key = childSnapshot.key;
            var childData = childSnapshot.val();
            var li = `<li><a target="_blank" href="/view.html?post=${key}">${childData.title}</a></li>`;
            postList.innerHTML = li + postList.innerHTML; // Add new items at the top
        });
    });

    imageInput.addEventListener('change', function() {
        imagePreview.innerHTML = '';
        Array.from(imageInput.files).forEach(function(file, index) {
            var reader = new FileReader();
            reader.onload = function(e) {
                var img = document.createElement('img');
                img.src = e.target.result;
                var deleteButton = document.createElement('div');
                deleteButton.textContent = 'Delete';
                deleteButton.classList.add('btn-delete');
                deleteButton.addEventListener('click', function() {
                    imageInput.value = '';
                    imagePreview.removeChild(img.parentNode);
                });
                var container = document.createElement('div');
                container.appendChild(img);
                container.appendChild(deleteButton);
                imagePreview.appendChild(container);
            };
            reader.readAsDataURL(file);
        });
    });

    document.getElementById('submit').addEventListener('click', function() {
        var title = document.getElementById('title').value;
        var paragraph = document.getElementById('paragraph').value;
        if (imageInput.files.length < 1 || title.length < 1 || paragraph.length < 1) {
          alert('Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß c√°c th√¥ng tin')
        }
        var images = Array.from(imageInput.files).map(function(file) {
            return new Promise(function(resolve, reject) {
                var reader = new FileReader();
                reader.onload = function(e) {
                    resolve(e.target.result);
                };
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        });

        function removeVietnameseTones(str) {
            str = str.replace(/√†|√°|·∫°|·∫£|√£|√¢|·∫ß|·∫•|·∫≠|·∫©|·∫´|ƒÉ|·∫±|·∫Ø|·∫∑|·∫≥|·∫µ/g, "a"); 
            str = str.replace(/√®|√©|·∫π|·∫ª|·∫Ω|√™|·ªÅ|·∫ø|·ªá|·ªÉ|·ªÖ/g, "e"); 
            str = str.replace(/√¨|√≠|·ªã|·ªâ|ƒ©/g, "i"); 
            str = str.replace(/√≤|√≥|·ªç|·ªè|√µ|√¥|·ªì|·ªë|·ªô|·ªï|·ªó|∆°|·ªù|·ªõ|·ª£|·ªü|·ª°/g, "o"); 
            str = str.replace(/√π|√∫|·ª•|·ªß|≈©|∆∞|·ª´|·ª©|·ª±|·ª≠|·ªØ/g, "u"); 
            str = str.replace(/·ª≥|√Ω|·ªµ|·ª∑|·ªπ/g, "y"); 
            str = str.replace(/ƒë/g, "d");
            str = str.replace(/√Ä|√Å|·∫†|·∫¢|√É|√Ç|·∫¶|·∫§|·∫¨|·∫®|·∫™|ƒÇ|·∫∞|·∫Æ|·∫∂|·∫≤|·∫¥/g, "A");
            str = str.replace(/√à|√â|·∫∏|·∫∫|·∫º|√ä|·ªÄ|·∫æ|·ªÜ|·ªÇ|·ªÑ/g, "E");
            str = str.replace(/√å|√ç|·ªä|·ªà|ƒ®/g, "I");
            str = str.replace(/√í|√ì|·ªå|·ªé|√ï|√î|·ªí|·ªê|·ªò|·ªî|·ªñ|∆†|·ªú|·ªö|·ª¢|·ªû|·ª†/g, "O");
            str = str.replace(/√ô|√ö|·ª§|·ª¶|≈®|∆Ø|·ª™|·ª®|·ª∞|·ª¨|·ªÆ/g, "U");
            str = str.replace(/·ª≤|√ù|·ª¥|·ª∂|·ª∏/g, "Y");
            str = str.replace(/ƒê/g, "D");
            str = str.replace(/ +/g, '-');
            return str.toLowerCase();
        }

        Promise.all(images).then(function(base64Images) {
            var cleanTitle = removeVietnameseTones(title);
            firebase.database().ref(cleanTitle).set({
                title: title,
                paragraph: paragraph,
                images: base64Images
            }).then(function() {
                alert('Post submitted successfully!');
                document.getElementById('title').value = '';
                document.getElementById('paragraph').value = '';
                imageInput.value = '';
                imagePreview.innerHTML = '';
            }).catch(function(error) {
                console.error('Error submitting post:', error);
            });
        });
    });
});
</script>


</body>
</html>